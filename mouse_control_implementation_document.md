# 鼠标控制功能实现文档

## 1. 功能需求

当用户点击集成软件中鼠标控制区域的"开始"按钮后，系统需要接管鼠标的运行控制，进行特定的自动操作，以便实现智能监控功能。

注意：所有提及的课程均默认为经过筛选的今日课程内容。

## 2. 鼠标控制逻辑模块数据调用功能

开发一个鼠标控制逻辑模块，该模块需要实现以下数据调用功能：
 1. 调用系统时间接口获取当前日期和时间信息
 2. 查询今日课程信息，包括课程名称、开始时间和结束时间
 3. 调用屏幕检测功能获取当前显示的界面信息
 4. 调用获取保存在/img路径下的图片资源，包括课程名称图标和按钮图标

注意：上述功能调用无固定执行顺序，仅为需要实现的数据调用列表。部分数据可能已在集成软件中完成调用，请先检查系统中已调用的数据项，避免重复调用。

## 3. 鼠标控制的主要行为模式

### 3.1 课程开始行为

当系统检测到当前时间点为课程开始时间之前，且该时间点之前没有正在进行或已结束的课程时，或当前时间有课程正在进行，需要控制鼠标执行一系列操作以进入指定的课程界面。

#### 3.1.1 触发条件
- 屏幕检测结果必须明确识别为"Course Menu"界面
- 必须符合预设的课程开始行为时间点

#### 3.1.2 课程图片调用与定位
- 系统需要调用即将开始的课程对应的图片资源
- 该图片已以课程名称命名并存储于/img/course路径下
- 系统需通过图像识别技术在屏幕中查找与该图片最高相似度的区域（考虑到可能存在多个相似区域）

#### 3.1.3 鼠标操作执行
- 软件需模拟鼠标控制行为，自动将光标移动至识别出的最高相似度区域
- 执行精准点击操作以启动课程

#### 3.1.4 执行过程监控
- 记录整个操作过程的日志，包括屏幕检测结果、图片匹配度、鼠标坐标及操作结果

### 3.2 课程切换行为

当系统检测到当前时间点处于前一节课结束之后且下一节课开始之前的过渡时段时，需要控制鼠标执行退出当前课程界面并返回到课程栏界面的操作，为进入下一节课做好准备。

### 3.3 行为模式切换机制

这两个主要行为模式的切换机制应基于当前系统时间与预设课程时间表的对比结果来实现。需要明确时间判断的具体逻辑和阈值条件，确保两种行为模式能够根据实际课程时间安排准确切换。

### 3.4 进入答题行为

当屏幕检测为Course Starts时，需要执行进入答题行为。

#### 3.4.1 触发条件
- 屏幕检测结果必须明确识别为"Course Starts"界面

#### 3.4.2 图片调用与定位
- 调用/img/course_starts路径下的join.PNG图片
- 系统需通过图像识别技术在屏幕中查找与该图片匹配的区域

#### 3.4.3 鼠标操作执行
- 控制鼠标移动到屏幕中与该图片符合的区域
- 执行点击操作以进入答题

### 3.5 答题行为

当屏幕检测为Poll Starts时，需要执行答题行为。

#### 3.5.1 触发条件
- 屏幕检测结果必须明确识别为"Poll Starts"界面

#### 3.5.2 图片调用与定位
- 调用/img/click路径下的a.PNG图片
- 系统需通过图像识别技术在屏幕中查找与该图片匹配的区域

#### 3.5.3 鼠标操作执行
- 控制鼠标移动到屏幕中与该图片符合的区域
- 执行点击操作以完成答题

#### 3.5.4 重复执行机制
- 答题行为可能需要在一天中多次重复运行
- 当执行答题行为的鼠标点击后，屏幕检测状态可能会切换为其他界面
- 当屏幕检测状态再次变为"Poll Starts"时，表示出现了一道新的题目
- 此时系统需要重新执行答题行为的完整流程（从触发条件开始）以完成新题目的答题操作